<div id="main-product" class="main" data-section-id="{{ section.id }}" data-product-section>
  <!--INFO-BUY-->
  <div class="buy-block">
    <!--PRODUCT INFO-->
    {%- assign productFormId = 'product-form-' | append: section.id -%}
    {%- form "product", product, id: productFormId, class: '' -%}
    <input type="hidden" name="product-id" value="{{- product.id -}}">
    <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}">
    {%- if product.has_only_default_variant -%}
    {%- elsif variants > 1 -%}
    class="product-variants"
    {%- endif -%}
    <div id="bag" class="bag
      {% if product.compare_at_price > product.price %}
      sale
      {% else %}
      {% endif %}
      {% if product.available %}
      {% else %}
      sold
      {% endif %}
    ">
      <div class="row">
        <div class="main-information">
          <div>{{ product.title }}</div>
          <div class="product-price">
            {% if product.available %}
            {% if product.price_varies %}
            <span>{{ product.price_min | money }}</span> â€“ <span>{{ product.price_max | money }}</span>
            {% else %}
            {% if product.compare_at_price > product.price %}
            <s>{{ product.compare_at_price | money }}</s>
            <span class="red">{{ product.price | money }}</span>
            {% else %}
            <span>{{ product.price | money }}</span>
            {% endif %}
            {% endif %}
            {% else %}
            <span>{{ product.price | money }}</span>
            {% endif %}
          </div>
          <form id="product-actions" action="/cart/add" method="post" enctype="multipart/form-data"
            {%- if product.has_only_default_variant -%}
            class="product-simple"
            {%- elsif variants > 1 -%}
            class="product-variants"
            {%- endif -%}>
            {% if product.compare_at_price > product.price %}
            <div class="onsale">ON SALE</div>
            {% else %}
            {% endif %}
            {% if product.available %}
            {% else %}
            <div class="sold-out">SOLD OUT</div>
            {% endif %}
          </form>
        </div>
      </div>
      <!-- Variations Dropdown -->
      {% render 'product-variants', product: product, formID: productFormId %}
      <div class="variations">
        <!-- Button Add To Bag -->
        {% liquid
        assign selectedVariant = product.selected_or_first_available_variant
        if selectedVariant.available
        assign addToCartText = 'ADD TO BAG'
        else
        assign addToCartText = 'SOLD OUT'
        endif
        %}
        <button id="add-to-bag" {% unless product.available %}disabled{% endunless %} type="submit" name="add" data-add-to-cart>
          <span class="" data-add-to-cart-text>
            {{ addToCartText }}
          </span>
        </button>
        {% assign product_qty = 0 %}
        {% for variant in product.variants %}
        {% if variant.inventory_quantity > 0 %}
        {% assign product_qty = product_qty | plus: variant.inventory_quantity %}
        {% endif %}
        {% endfor %}
      </div>
    </div>
    {% if product_qty < 2 %}
    <div class="menu-title left">({{ product_qty }} LEFT)</div>
    {% endif %}
    {% endform %}
    <div class="product_information">
      <div class="extra">
        {% unless product.metafields.custom.extra_info == blank %}
        {{ product.metafields.custom.extra_info }}
        {% endunless %}
      </div>
    </div>
    {% assign info = product.metafields.custom.info | default: '' %}
    {% assign shipping = product.metafields.custom.shiiping | default: '' %}
    {% assign policies = product.metafields.custom.policies | default: '' %}

    {% if info != blank %}
      <div class="custom-metafield">
        {{% product.metafields.custom.info %}}
      </div>
    {% endif %}
  </div>
  <!--GALLERY-->
  <div class="product_gallery">
    {% for media in product.media %}
    {% case media.media_type %}
    {% when 'video' %}
    {{ media | video_tag:loop: true, autoplay: true, muted:true}}
    {% endcase %}
    {% case media.media_type %}
    {% when 'image' %}
    <img class="lazy" src="{{ media | product_img_url: 'thumb' }}" data-src="{{ media | product_img_url: 'master' }}" alt="{{ media.alt }}"/>
    {% endcase %}
    {% endfor %}
  </div>
</div>
